package com.example.hello

import android.annotation.SuppressLint
import android.annotation.TargetApi
import android.content.Context
import android.hardware.ConsumerIrManager
import android.media.MediaPlayer
import android.os.Build
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import android.os.Vibrator
import android.util.SparseArray
import android.view.View
import android.widget.Button
import androidx.appcompat.app.ActionBar
import androidx.core.content.ContextCompat
import butterknife.ButterKnife
import java.lang.reflect.InvocationTargetException
import java.lang.reflect.Method
import java.util.Arrays

class Sony : AppCompatActivity() {
    var mCIR: ConsumerIrManager? = null
    var irdaService: Any? = null
    var irWrite: Method? = null
    var irData: SparseArray<String>? = null
    var mediaPlayer: MediaPlayer? = null
    private var soundBoolean: Boolean = true
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_sony)
        supportActionBar?.hide()
        val arrow: Button = findViewById(R.id.arrow)
        arrow.setOnClickListener {
            onBackPressed()
        }
        mediaPlayer = MediaPlayer.create(this, R.raw.ss)


        window.setStatusBarColor(ContextCompat.getColor(this, R.color.stop));
        ButterKnife.bind(this)

        val actionBar: ActionBar? = supportActionBar
        actionBar?.setDisplayShowHomeEnabled(true)
        actionBar?.setLogo(R.drawable.icon) // Replace with your image resource
        actionBar?.setDisplayUseLogoEnabled(true)

        irData = SparseArray()
        irData!!.put(
            R.id.sonyB_power,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_rec,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_stop,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_tms,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_media,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_audio,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_rew,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_ff,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_tvradio,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_red,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_green,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_blue,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_yellow,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_menu,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_exit,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_epg,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_fav,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_up,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_down,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_right,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_left,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_ok,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_chup,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_chdown,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_mute,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_back,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_volup,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_voldown,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_1,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_2,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_3,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_4,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_5,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_6,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_7,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_8,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_9,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_help,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_0,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )
        irData!!.put(
            R.id.sonyB_info,
            hex2dec("0000 006D 0022 0002 0155 00AA 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 05ED 0155 0055 0015 0E47")
        )

        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
            irInit4KitKat()
        } else {
            irInit4JellyBean()
        }
    }

    @TargetApi(Build.VERSION_CODES.KITKAT)
    fun irInit4KitKat() {
        mCIR = getSystemService(CONSUMER_IR_SERVICE) as? ConsumerIrManager
        // Continue with the code that depends on mCIR
    }

    @SuppressLint("WrongConstant")
    fun irInit4JellyBean() {
        irdaService = this.getSystemService("irda")
        val c: Class<*> = irdaService?.javaClass ?: return
        val p = arrayOf<Class<*>>(String::class.java)
        try {
            irWrite = c.getMethod("write_irsend", *p)
        } catch (e: NoSuchMethodException) {
            e.printStackTrace()
        }
    }

    fun irSend(view: View) {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
            irSend4Kitkat(view)
        } else {
            irSend4JellyBean(view)
        }
        val soundBoolean: Boolean = true
        val vibrationBoolean: Boolean = true
        mediaPlayer?.let { player ->
            if (soundBoolean) {
                player.start()
            } else {
                player.pause()
            }
        }
        if (vibrationBoolean) {
            val vibrator: Vibrator = getSystemService(Context.VIBRATOR_SERVICE) as Vibrator
            vibrator.vibrate(30)
        }
    }

    override fun onResume() {
        val getsound = getSharedPreferences("soundswitch", MODE_PRIVATE)
        soundBoolean = getsound.getBoolean("soundswitch", true)
        if (soundBoolean) {
            mediaPlayer?.start()
        } else {
            mediaPlayer?.pause()
        }
        super.onResume()
    }


    override fun onDestroy() {
        super.onDestroy()
        val vibrator: Vibrator = getSystemService(Context.VIBRATOR_SERVICE) as Vibrator
        // Release the MediaPlayer when the activity is destroyed
        if (mediaPlayer != null) {
            mediaPlayer?.release()
            vibrator.cancel()
        }
    }

    @TargetApi(Build.VERSION_CODES.KITKAT)
    private fun irSend4Kitkat(view: View) {
        val data = irData!![view.id]
        if (data != null) {
            val values = data.split(",".toRegex()).dropLastWhile { it.isEmpty() }.toTypedArray()
            val pattern = IntArray(values.size - 1)
            for (i in pattern.indices) {
                pattern[i] = values[i + 1].toInt()
            }
            mCIR!!.transmit(values[0].toInt(), pattern)
        }
    }

    private fun irSend4JellyBean(view: View) {
        val data = irData!![view.id]
        if (data != null) {
            try {
                irWrite!!.invoke(irdaService, data)
            } catch (e: IllegalArgumentException) {
                e.printStackTrace()
            } catch (e: IllegalAccessException) {
                e.printStackTrace()
            } catch (e: InvocationTargetException) {
                e.printStackTrace()
            }
        }
    }

    protected fun hex2dec(irData: String): String {
        var irData = irData
        val list: MutableList<String> = ArrayList(
            Arrays.asList(
                *irData
                    .split(" ".toRegex()).dropLastWhile { it.isEmpty() }.toTypedArray()
            )
        )
        list.removeAt(0) // dummy
        var frequency = list.removeAt(0).toInt(16) // frequency
        list.removeAt(0) // seq1
        list.removeAt(0) // seq2
        for (i in list.indices) {
            list[i] = Integer.toString(list[i].toInt(16))
        }
        frequency = (1000000 / (frequency * 0.241246)).toInt()
        list.add(0, Integer.toString(frequency))
        irData = ""
        for (s in list) {
            irData += "$s,"
            // Log.i("IRDTAE",irData);
        }
        irData = count2duration(irData)
        return irData
    }

    protected fun count2duration(countPattern: String): String {
        val list: MutableList<String> = ArrayList(
            Arrays.asList(
                *countPattern.split(",".toRegex()).dropLastWhile { it.isEmpty() }
                    .toTypedArray()))
        val frequency = list[0].toInt()
        val pulses = 1000000 / frequency
        var count: Int
        var duration: Int
        list.removeAt(0)
        for (i in list.indices) {
            count = list[i].toInt()
            duration = count * pulses
            list[i] = Integer.toString(duration)
        }
        var durationPattern = ""
        for (i in 0 until list.size - 1) {
            durationPattern += list[i] + ","
        }
        return "$frequency,$durationPattern"
    }

    companion object {
        val TAG = Sony::class.java.simpleName
    }
    }
